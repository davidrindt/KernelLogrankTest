data("kidney")
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(kidney)
library('survival')
myData = data("kidney")
myData = myData
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(kidney)
View(kidney)
library('survival')
myData = data("kidney")
myData = myData[-c()]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
myData = data("kidney")
myData = myData[-c(21)]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
a = data("kidney")
b = a[-c(21)]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
a = data("kidney")
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
a <- data("kidney")
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
a <- list(data("kidney"))
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(a)
library('survival')
a <- data.frame((data("kidney")))
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(a)
library('survival')
data("kidney")
a = data.frame(kidney)
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(a)
library('survival')
data("kidney")
a = data.frame(kidney)
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(kidney)
library('survival')
data("kidney")
a = data.frame(kidney)
b = a[-c(21),]
mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
plot(cars)
plot(cars)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=1), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=2), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=3), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=4), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(diabetic)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ *, data=diabetic)
mfit
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ *, data=diabetic)
mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ , data=diabetic)
mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("diabetic")
a = data.frame(diabetic)
write.csv(diabetic, 'diabetic')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ . , data=diabetic)
mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library('survival')
data("leukemia")
a = data.frame(leukemia)
write.csv(leukemia, 'leukemia')
install.packages(c("survival", "condSURV", "JM", "dplyr", "survminer", "ggplot2"))
devtools::install_github("noramvillanueva/clustcurv")
install.packages(c("survival", "condSURV", "JM", "dplyr", "survminer", "ggplot2"))
library(survival)
library(condSURV)
library(JM)
library(dplyr)
library(survminer)
library(clustcurv)
library(ggplot2)
data("leukemia")
a = data.frame(leukemia)
write.csv(leukemia, 'leukemia')
data('loan')
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=0), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
library(survival)
library(condSURV)
library(JM)
library(dplyr)
library(survminer)
library(clustcurv)
library(ggplot2)
data("leukemia")
a = data.frame(leukemia)
write.csv(leukemia, 'leukemia')
web <- "https://s3.amazonaws.com/udacity-hosted-downloads/ud651/prosperLoanData.csv"
loan <- read.csv(web)
# b = a[-c(21),]
# mfit <- coxph(Surv(time, status) ~ sex + pspline(age, df=3), data=kidney)
# mfit
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
mfit <- coxph(Surv(time, status) ~ trt + pspline(risk, df=0), data=diabetic)
mfit
termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
attributes(ptemp)
# mfit <- coxph(Surv(futime, death) ~ sex + pspline(age, df=20), data=mgus)
# mfit
#
# termplot(mfit, term=2, se=TRUE, col.term=1, col.se=1)
#
# ptemp <- termplot(mfit, se=TRUE, plot=FALSE)
# attributes(ptemp)
View(loan)
loan_nd <- loan[unique(loan$LoanKey), ]
sel_status  <- loan_nd$LoanStatus %in% c("Completed", "Current",
"ChargedOff", "Defaulted",
"Cancelled")
loan_filtered <- loan_nd[sel_status, ]
View(loan_nd)
View(loan_nd)
View(loan)
View(loan_nd)
loan_nd <- distinct(loan, LoanKey)
loan_nd[!duplicated(loan$LoanKey), ]
loan_nd <- loan[!duplicated(loan$LoanKey), ]
View(loan_nd)
sel_status  <- loan_nd$LoanStatus %in% c("Completed", "Current",
"ChargedOff", "Defaulted",
"Cancelled")
loan_filtered <- loan_nd[sel_status, ]
View(loan_filtered)
loan_filtered$status <- ifelse(
loan_filtered$LoanStatus == "Defaulted" |
loan_filtered$LoanStatus == "Chargedoff",  1, 0)
View(loan_filtered)
head(levels(loan_filtered$ClosedDate))
## [1] ""                    "2005-11-25 00:00:00" "2005-11-29 00:00:00"
## [4] "2005-11-30 00:00:00" "2005-12-08 00:00:00" "2005-12-28 00:00:00"
levels(loan_filtered$ClosedDate)[1] <- "2014-11-03 00:00:00"
# creating the time-to-event variable
loan_filtered$start <- as.Date(loan_filtered$LoanOriginationDate)
loan_filtered$end <- as.Date(loan_filtered$ClosedDate)
loan_filtered$time <- as.numeric(difftime(loan_filtered$end, loan_filtered$start, units = "days"))
# there is an error in the data (time to event less than 0)
loan_filtered <- loan_filtered[-loan_filtered$time < 0, ]
# just considering a year of loans creation
ii <- format(as.Date(loan_filtered$LoanOriginationDate),'%Y') %in% c("2006")
loan_filtered <- loan_filtered[ii, ]
View(loan_filtered)
loan_filtered$LoanOriginalAmount2
loan_filtered$LoanOriginalAmount2 <-  loan_filtered$LoanOriginalAmount/10000
View(loan_filtered)
to_save_data <- loan_filtered[, c("IsBorrowerHomeowner", "LoanOriginalAmount2")]
View(to_save_data)
write.csv(to_save_data, 'loan_data')
setwd("~/Documents/Repositories/kernel_logrank_python_code/data")
write.csv(to_save_data, 'loan_data')
data("melanoma", package = "boot")
# Then we munge it according to ?boot::melanoma
library(dplyr)
library(magrittr)
melanoma %<>%
mutate(status = factor(status,
levels = 1:3,
labels = c("Died from melanoma",
"Alive",
"Died from other causes")),
ulcer = factor(ulcer,
levels = 0:1,
labels = c("Absent", "Present")),
time = time/365.25, # All variables should be in the same time unit
sex = factor(sex,
levels = 0:1,
labels = c("Female", "Male")))
View(melanoma)
write.csv(melanoma, 'melanoma')
setwd("/data/falconet/rindt/Repositories/kernel_logrank_python_code/data")
write.csv(melanoma, 'melanoma')
View(melanoma)
